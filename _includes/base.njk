<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% if title and title != 'Home' %}{{ title }} | Droe{% else %}Droe - Unified Programming System{% endif %}</title>
  <meta name="description" content="{% if description %}{{ description }}{% else %}Droe is a unified programming system that compiles high-level app definitions to native, web, mobile, and server runtimes.{% endif %}">
  
  <!-- Favicon -->
  <link rel="icon" href="/logo.png">
  <link rel="icon" type="image/png" href="/logo.png">
  <link rel="apple-touch-icon" href="/logo.png">
  
  <!-- Styles -->
  <link rel="stylesheet" href="/style.css">
  
  <!-- Meta tags -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="{% if title and title != 'Home' %}{{ title }} | Droe{% else %}Droe - Unified Programming System{% endif %}">
  <meta property="og:description" content="{% if description %}{{ description }}{% else %}Unified programming system that compiles to native, web, mobile, and server runtimes{% endif %}">
  <meta property="og:url" content="https://droe.dev{{ page.url }}">
  <meta property="og:image" content="https://droe.dev/logo.png">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{% if title and title != 'Home' %}{{ title }} | Droe{% else %}Droe - Unified Programming System{% endif %}">
  <meta name="twitter:description" content="{% if description %}{{ description }}{% else %}Unified programming system that compiles to native, web, mobile, and server runtimes{% endif %}">
  <meta name="twitter:image" content="https://droe.dev/logo.png">
</head>
<body class="bg-white text-gray-900 antialiased">
  <!-- Main Content -->
  <main>
    {{ content | safe }}
  </main>

  <!-- JavaScript for mobile menu -->
  <script>
    document.getElementById('mobile-menu-button').addEventListener('click', function() {
      const menu = document.getElementById('mobile-menu');
      menu.classList.toggle('hidden');
    });
  </script>
<script>
  document.addEventListener('DOMContentLoaded', (event) => {
    const sidebar = document.getElementById('sidebar');
    if (sidebar) {
      const scrollPos = sessionStorage.getItem('sidebarScroll');
      if (scrollPos) {
        sidebar.scrollTop = parseInt(scrollPos, 10);
      }

      window.addEventListener('beforeunload', () => {
        sessionStorage.setItem('sidebarScroll', sidebar.scrollTop);
      });
    }

    // Add copy buttons to all code blocks
    const codeBlocks = document.querySelectorAll('pre code');
    codeBlocks.forEach((codeBlock) => {
      const pre = codeBlock.parentElement;
      pre.style.position = 'relative';
      
      const button = document.createElement('button');
      button.className = 'copy-btn';
      button.innerHTML = `
        <svg class="copy-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
          <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
        </svg>
        <svg class="check-icon" style="display:none;" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20 6L9 17l-5-5"></path>
        </svg>
      `;
      button.style.cssText = `
        position: absolute;
        top: 8px;
        right: 8px;
        padding: 6px;
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        cursor: pointer;
        opacity: 0;
        transition: opacity 0.2s, background-color 0.2s;
        display: flex;
        align-items: center;
        gap: 4px;
        color: #6b7280;
      `;
      
      pre.appendChild(button);
      
      // Show button on hover
      pre.addEventListener('mouseenter', () => {
        button.style.opacity = '1';
      });
      
      pre.addEventListener('mouseleave', () => {
        if (!button.classList.contains('copied')) {
          button.style.opacity = '0';
        }
      });
      
      button.addEventListener('click', async () => {
        const code = codeBlock.textContent;
        try {
          await navigator.clipboard.writeText(code);
          
          // Show success state
          button.classList.add('copied');
          button.style.background = '#10b981';
          button.style.borderColor = '#10b981';
          button.style.color = 'white';
          button.querySelector('.copy-icon').style.display = 'none';
          button.querySelector('.check-icon').style.display = 'block';
          
          setTimeout(() => {
            button.classList.remove('copied');
            button.style.background = 'rgba(255, 255, 255, 0.9)';
            button.style.borderColor = '#e5e7eb';
            button.style.color = '#6b7280';
            button.querySelector('.copy-icon').style.display = 'block';
            button.querySelector('.check-icon').style.display = 'none';
            button.style.opacity = '0';
          }, 2000);
        } catch (err) {
          console.error('Failed to copy:', err);
        }
      });
    });
  });
</script>
</body>
</html>

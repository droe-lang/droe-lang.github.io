<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Endpoints | Droe</title>
  <meta name="description" content="Create HTTP REST APIs and make API calls with Droelang&#39;s built-in HTTP DSL.">

  <!-- Favicon -->
  <link rel="icon" href="/logo.png">
  <link rel="icon" type="image/png" href="/logo.png">
  <link rel="apple-touch-icon" href="/logo.png">

  <!-- Styles -->
  <link rel="stylesheet" href="/style.css">

  <!-- Meta tags -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="API Endpoints | Droe">
  <meta property="og:description"
    content="Create HTTP REST APIs and make API calls with Droelang&#39;s built-in HTTP DSL.">
  <meta property="og:url" content="https://droe.dev/guide/api-endpoints/">
  <meta property="og:image" content="https://droe.dev/logo.png">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="API Endpoints | Droe">
  <meta name="twitter:description"
    content="Create HTTP REST APIs and make API calls with Droelang&#39;s built-in HTTP DSL.">
  <meta name="twitter:image" content="https://droe.dev/logo.png">
</head>

<body class="bg-white text-gray-900 antialiased">
  <!-- Main Content -->
  <main>

    <!-- Mobile drawer overlay -->
    <div id="drawer-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-[60] hidden lg:hidden"></div>

    <!-- Main Layout Container -->
    <div class="flex flex-col lg:flex-row">
      <!-- Sidebar Navigation -->
      <aside id="sidebar"
        class="fixed inset-y-0 left-0 z-[70] w-64 bg-gray-50 transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out h-screen lg:sticky lg:top-0 lg:h-screen overflow-y-auto pb-4 lg:pb-16">
        <div class="p-6">
          <h2 class="font-semibold text-gray-900 mb-4">Documentation</h2>

          <!-- Getting Started -->
          <div class="mb-6">
            <h3 class="text-sm font-medium text-gray-500 uppercase tracking-wider mb-3">Getting Started</h3>
            <nav class="space-y-1">
              <a href="/guide/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Introduction</a>
              <a href="/guide/installation/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Installation</a>
              <a href="/guide/quick-start/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Quick
                Start</a>
              <a href="/guide/project-structure/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Project
                Structure</a>
            </nav>
          </div>

          <!-- Language Guide -->
          <div class="mb-6">
            <h3 class="text-sm font-medium text-gray-500 uppercase tracking-wider mb-3">Language Guide</h3>
            <nav class="space-y-1">
              <a href="/guide/basics/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Basic
                Syntax</a>
              <a href="/guide/types/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Type
                System</a>
              <a href="/guide/variables/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Variables</a>
              <a href="/guide/strings/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Strings
                & Interpolation</a>
              <a href="/guide/collections/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Collections</a>
              <a href="/guide/conditionals/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Conditionals</a>
              <a href="/guide/loops/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Loops</a>
            </nav>
          </div>

          <!-- Advanced -->
          <div class="mb-6">
            <h3 class="text-sm font-medium text-gray-500 uppercase tracking-wider mb-3">Advanced</h3>
            <nav class="space-y-1">
              <a href="/guide/modules/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Modules</a>
              <a href="/guide/actions/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Actions</a>
              <a href="/guide/data-structures/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Data
                Structures</a>
              <a href="/guide/task-actions/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Task
                Actions</a>
            </nav>
          </div>

          <!-- Backend Development -->
          <div class="mb-6">
            <h3 class="text-sm font-medium text-gray-500 uppercase tracking-wider mb-3">Backend Development</h3>
            <nav class="space-y-1">
              <a href="/guide/database/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Database
                DSL</a>
              <a href="/guide/api-endpoints/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">API
                Endpoints</a>
            </nav>
          </div>

          <!-- Frontend & Mobile -->
          <div class="mb-6">
            <h3 class="text-sm font-medium text-gray-500 uppercase tracking-wider mb-3">Frontend & Mobile</h3>
            <nav class="space-y-1">
              <a href="/guide/ui-components/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">UI
                Components</a>
              <a href="/guide/mobile/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Mobile
                Development</a>
            </nav>
          </div>

          <!-- Tools -->
          <div class="mb-6">
            <h3 class="text-sm font-medium text-gray-500 uppercase tracking-wider mb-3">Tools</h3>
            <nav class="space-y-1">
              <a href="/guide/cli/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">CLI
                Reference</a>
              <a href="/guide/webassembly/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">WebAssembly</a>
              <a href="/guide/frameworks/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Framework
                Support</a>
              <a href="/guide/debugging/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Debugging</a>
              <a href="/guide/implementation-status/"
                class="block px-3 py-2 text-sm text-gray-700 hover:text-primary-600 hover:bg-white rounded-md transition-colors">Implementation
                Status</a>
            </nav>
          </div>
        </div>
      </aside>

      <!-- Main Content -->
      <div class="flex-1 flex flex-col min-h-screen w-full lg:w-auto" id="main-content">
        <nav class="sticky top-0 z-50 bg-white/80 backdrop-blur-sm border-b border-gray-200">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
              <!-- Logo -->
              <div class="flex items-center">
                <a href="/"
                  class="flex items-center space-x-2 text-xl font-bold text-gray-900 hover:text-primary-600 transition-colors">
                  <img src="/logo.png" alt="Droe" class="w-6 h-6">
                  <span>Droe</span>
                </a>
              </div>

              <!-- Navigation Links -->
              <div class="hidden md:flex items-center space-x-8">
                <a href="/guide/" class="nav-link">Guide</a>
                <a href="https://github.com/droe-lang/droe/tree/main/examples" target="_blank" rel="noopener"
                  class="nav-link">Examples</a>
                <a href="https://github.com/droe-lang/droe" target="_blank" rel="noopener" class="nav-link">
                  <span class="sr-only">GitHub</span>
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd"
                      d="M10 0C4.477 0 0 4.484 0 10.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0110 4.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.203 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.942.359.31.678.921.678 1.856 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0020 10.017C20 4.484 15.522 0 10 0z"
                      clip-rule="evenodd"></path>
                  </svg>
                </a>
              </div>

              <!-- Mobile Menu Button -->
              <div class="md:hidden">
                <button id="mobile-menu-button"
                  class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500">
                  <span class="sr-only">Open main menu</span>
                  <!-- Icon for menu (hamburger) -->
                  <svg class="h-6 w-6 block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-4 6h-8" />
                  </svg>
                  <!-- Icon for close (X) -->
                  <svg class="h-6 w-6 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>
              </div>
            </div>

            <!-- Mobile Menu -->
            <div id="mobile-menu" class="md:hidden hidden">
              <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="/guide/"
                  class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50">Guide</a>
                <a href="https://github.com/droe-lang/droe/tree/main/examples" target="_blank" rel="noopener"
                  class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50">Examples</a>
                <a href="https://github.com/droe-lang/droe" target="_blank" rel="noopener"
                  class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50">GitHub</a>
              </div>
            </div>
          </div>
        </nav>

        <!-- Mobile Menu Bar (only visible on mobile) -->
        <div class="lg:hidden bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between">
          <button id="menu-toggle-btn"
            class="flex items-center space-x-2 px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md transition-colors">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
            <span>Menu</span>
          </button>
          <div class="text-sm text-gray-500">Documentation</div>
        </div>

        <main class="flex-grow p-6 lg:p-12">
          <div class="overflow-x-auto">
            <article class="prose dark:prose-invert max-w-none">
              <h1>API Endpoints</h1>
              <p>Droelang provides native support for creating HTTP REST APIs and making API calls with a clean,
                declarative syntax.</p>
              <h2>Defining HTTP Endpoints</h2>
              <p>Use the <code>serve</code> statement to define REST HTTP endpoints:</p>
              <pre><code class="language-droe">// GET endpoint
serve get /users/:id
    set user from db find User where id equals id
    when user is empty then
        respond 404 with &quot;User not found&quot;
    end when
    respond 200 with user
end serve

// POST endpoint  
serve post /users
    db create User from request.body
    respond 201 with created_user
end serve

// PUT endpoint
serve put /users/:id
    db update User where id equals id set name is request.name
    respond 200 with updated_user
end serve

// DELETE endpoint
serve delete /users/:id
    db delete User where id equals id
    respond 204
end serve
</code></pre>
              <h2>HTTP Methods</h2>
              <p>Droelang supports all standard HTTP methods:</p>
              <table>
                <thead>
                  <tr>
                    <th>Method</th>
                    <th>Purpose</th>
                    <th>Example</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><code>GET</code></td>
                    <td>Retrieve data</td>
                    <td><code>serve get /users</code></td>
                  </tr>
                  <tr>
                    <td><code>POST</code></td>
                    <td>Create new resource</td>
                    <td><code>serve post /users</code></td>
                  </tr>
                  <tr>
                    <td><code>PUT</code></td>
                    <td>Update existing resource</td>
                    <td><code>serve put /users/:id</code></td>
                  </tr>
                  <tr>
                    <td><code>DELETE</code></td>
                    <td>Delete resource</td>
                    <td><code>serve delete /users/:id</code></td>
                  </tr>
                  <tr>
                    <td><code>PATCH</code></td>
                    <td>Partial update</td>
                    <td><code>serve patch /users/:id</code></td>
                  </tr>
                </tbody>
              </table>
              <h2>URL Parameters</h2>
              <p>Extract parameters from URLs using the <code>:parameter</code> syntax:</p>
              <pre><code class="language-droe">serve get /users/:user_id/posts/:post_id
    set user from db find User where id equals user_id
    set post from db find Post where id equals post_id and author_id equals user_id
    
    when user is empty then
        respond 404 with &quot;User not found&quot;
    end when
    
    when post is empty then
        respond 404 with &quot;Post not found&quot;
    end when
    
    respond 200 with post
end serve
</code></pre>
              <h2>Request Data</h2>
              <p>Access request data through the <code>request</code> object:</p>
              <pre><code class="language-droe">serve post /users
    // Access request body
    set user_data from request.body
    set name from request.body.name
    set email from request.body.email
    
    // Validate required fields
    when name is empty or email is empty then
        respond 400 with &quot;Name and email are required&quot;
    end when
    
    // Create user
    db create User with name is name, email is email
    respond 201 with created_user
end serve
</code></pre>
              <h2>Response Handling</h2>
              <h3>Status Codes and Data</h3>
              <pre><code class="language-droe">serve get /users/:id
    set user from db find User where id equals id
    
    when user is empty then
        respond 404 with '{&quot;error&quot;: &quot;User not found&quot;}'
    end when
    
    respond 200 with user
end serve

serve post /users
    // Validation
    when request.body.email is invalid then
        respond 422 with '{&quot;error&quot;: &quot;Invalid email format&quot;}'
    end when
    
    // Create user
    db create User from request.body
    respond 201 with created_user
end serve
</code></pre>
              <h3>Common HTTP Status Codes</h3>
              <table>
                <thead>
                  <tr>
                    <th>Code</th>
                    <th>Meaning</th>
                    <th>Usage</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><code>200</code></td>
                    <td>OK</td>
                    <td>Successful GET, PUT</td>
                  </tr>
                  <tr>
                    <td><code>201</code></td>
                    <td>Created</td>
                    <td>Successful POST</td>
                  </tr>
                  <tr>
                    <td><code>204</code></td>
                    <td>No Content</td>
                    <td>Successful DELETE</td>
                  </tr>
                  <tr>
                    <td><code>400</code></td>
                    <td>Bad Request</td>
                    <td>Invalid request data</td>
                  </tr>
                  <tr>
                    <td><code>404</code></td>
                    <td>Not Found</td>
                    <td>Resource doesn't exist</td>
                  </tr>
                  <tr>
                    <td><code>422</code></td>
                    <td>Unprocessable Entity</td>
                    <td>Validation errors</td>
                  </tr>
                  <tr>
                    <td><code>500</code></td>
                    <td>Internal Server Error</td>
                    <td>Server errors</td>
                  </tr>
                </tbody>
              </table>
              <h2>Making API Calls</h2>
              <h3>Basic API Call Syntax</h3>
              <pre><code class="language-droe">call &lt;endpoint&gt; method &lt;HTTP_METHOD&gt; [with &lt;data&gt;] [using headers &lt;headers&gt;] into &lt;response_variable&gt;
</code></pre>
              <h3>GET Request</h3>
              <pre><code class="language-droe">// Simple GET request
call &quot;https://api.example.com/users&quot; method GET into response
display response

// GET with headers
call &quot;https://api.example.com/profile&quot; method GET using headers
    Authorization: &quot;Bearer token123&quot;
    Accept: &quot;application/json&quot;
end headers into profile_data
</code></pre>
              <h3>POST Request</h3>
              <pre><code class="language-droe">// POST with JSON data
set user_data which is text to '{&quot;name&quot;: &quot;Alice&quot;, &quot;email&quot;: &quot;alice@example.com&quot;}'
call &quot;https://api.example.com/users&quot; method POST with user_data using headers
    Content-Type: &quot;application/json&quot;
    Authorization: &quot;Bearer token123&quot;
end headers into create_response

// POST with form data
set form_data which is text to &quot;username=alice&amp;password=secret&quot;
call &quot;https://api.example.com/login&quot; method POST with form_data using headers
    Content-Type: &quot;application/x-www-form-urlencoded&quot;
end headers into login_response
</code></pre>
              <h3>PUT and DELETE Requests</h3>
              <pre><code class="language-droe">// PUT request
set update_data which is text to '{&quot;name&quot;: &quot;Alice Smith&quot;}'
call &quot;https://api.example.com/users/123&quot; method PUT with update_data using headers
    Content-Type: &quot;application/json&quot;
    Authorization: &quot;Bearer token123&quot;
end headers into update_response

// DELETE request
call &quot;https://api.example.com/users/123&quot; method DELETE using headers
    Authorization: &quot;Bearer token123&quot;
end headers into delete_response
</code></pre>
              <h2>API Response Handling</h2>
              <pre><code class="language-droe">// Make API call
call &quot;https://api.example.com/data&quot; method GET into response

// Check response status
when response.status equals 200 then
    display &quot;Success: &quot; + response.body
otherwise when response.status equals 404 then
    display &quot;Not found&quot;
otherwise
    display &quot;Error: &quot; + response.status
end when

// Parse JSON response (automatic in supported targets)
set data from response.body
display &quot;User name: &quot; + data.name
</code></pre>
              <h2>Complete API Example</h2>
              <p>Here's a complete blog API example:</p>
              <pre><code class="language-droe">@target droe

module blog_api

    data Article
        id is text key auto
        title is text required
        content is text required
        author is text required
        published is flag default false
        created_at is date auto
    end data
    
    // List all articles
    serve get /articles
        set articles from db find all Article where published equals true
        respond 200 with articles
    end serve
    
    // Get single article
    serve get /articles/:id
        set article from db find Article where id equals id
        when article is empty then
            respond 404 with '{&quot;error&quot;: &quot;Article not found&quot;}'
        end when
        respond 200 with article
    end serve
    
    // Create article
    serve post /articles
        set new_article from request.body
        
        // Validation
        when new_article.title is empty then
            respond 400 with '{&quot;error&quot;: &quot;Title is required&quot;}'
        end when
        
        when new_article.content is empty then
            respond 400 with '{&quot;error&quot;: &quot;Content is required&quot;}'
        end when
        
        db create Article from new_article
        respond 201 with new_article
    end serve
    
    // Update article
    serve put /articles/:id
        set article from db find Article where id equals id
        when article is empty then
            respond 404 with '{&quot;error&quot;: &quot;Article not found&quot;}'
        end when
        
        db update Article where id equals id set 
            title is request.title,
            content is request.content
        respond 200 with updated_article
    end serve
    
    // Delete article
    serve delete /articles/:id
        set article from db find Article where id equals id
        when article is empty then
            respond 404 with '{&quot;error&quot;: &quot;Article not found&quot;}'
        end when
        
        db delete Article where id equals id
        respond 204
    end serve
    
    // Publish article
    serve post /articles/:id/publish
        set article from db find Article where id equals id
        when article is empty then
            respond 404 with '{&quot;error&quot;: &quot;Article not found&quot;}'
        end when
        
        db update Article where id equals id set published is true
        respond 200 with '{&quot;message&quot;: &quot;Article published&quot;}'
    end serve

end module
</code></pre>
              <h2>Advanced Features</h2>
              <h3>Middleware and Authentication</h3>
              <pre><code class="language-droe">serve get /admin/users
    // Check authorization
    when request.headers.Authorization is empty then
        respond 401 with '{&quot;error&quot;: &quot;Authorization required&quot;}'
    end when
    
    set token from request.headers.Authorization
    when token is not valid then
        respond 403 with '{&quot;error&quot;: &quot;Invalid token&quot;}'
    end when
    
    // Proceed with authorized request
    set users from db find all User
    respond 200 with users
end serve
</code></pre>
              <h3>Query Parameters</h3>
              <pre><code class="language-droe">serve get /users
    // Handle pagination
    set page from request.query.page or 1
    set limit from request.query.limit or 10
    set offset to (page - 1) * limit
    
    // Handle search
    set search from request.query.search
    when search is not empty then
        set users from db find all User where name contains search limit limit offset offset
    otherwise
        set users from db find all User limit limit offset offset
    end when
    
    respond 200 with users
end serve
</code></pre>
              <h3>Request Validation</h3>
              <pre><code class="language-droe">serve post /users
    set email from request.body.email
    set name from request.body.name
    
    // Validate email format
    when email does not match email_pattern then
        respond 422 with '{&quot;error&quot;: &quot;Invalid email format&quot;}'
    end when
    
    // Check if user exists
    set existing from db find User where email equals email
    when existing is not empty then
        respond 409 with '{&quot;error&quot;: &quot;User already exists&quot;}'
    end when
    
    // Create user
    db create User with name is name, email is email
    respond 201 with created_user
end serve
</code></pre>
              <h2>Framework Integration</h2>
              <p>When compiling with framework targets, API endpoints generate appropriate framework code:</p>
              <h3>Rust + Axum</h3>
              <pre><code class="language-rust">// Generated route handler
pub async fn get_user(
    State(pool): State&lt;PgPool&gt;,
    Path(id): Path&lt;String&gt;
) -&gt; Result&lt;Json&lt;User&gt;, StatusCode&gt; {
    let user = sqlx::query_as!(User, &quot;SELECT * FROM users WHERE id = $1&quot;, id)
        .fetch_optional(&amp;pool)
        .await
        .map_err(|_| StatusCode::INTERNAL_SERVER_ERROR)?;
        
    match user {
        Some(user) =&gt; Ok(Json(user)),
        None =&gt; Err(StatusCode::NOT_FOUND),
    }
}

// Route registration
let app = Router::new()
    .route(&quot;/users/:id&quot;, get(get_user))
    .with_state(pool);
</code></pre>
              <h2>Best Practices</h2>
              <h3>1. Use Proper HTTP Status Codes</h3>
              <pre><code class="language-droe">// Good: Appropriate status codes
serve post /users
    when validation_failed then
        respond 422 with validation_errors  // Unprocessable Entity
    end when
    
    when user_exists then
        respond 409 with conflict_message   // Conflict
    end when
    
    db create User from request.body
    respond 201 with created_user           // Created
end serve
</code></pre>
              <h3>2. Validate Input Data</h3>
              <pre><code class="language-droe">// Good: Comprehensive validation
serve put /users/:id
    when request.body is empty then
        respond 400 with '{&quot;error&quot;: &quot;Request body required&quot;}'
    end when
    
    when request.body.name is empty then
        respond 422 with '{&quot;error&quot;: &quot;Name is required&quot;}'
    end when
    
    when request.body.email is invalid then
        respond 422 with '{&quot;error&quot;: &quot;Invalid email format&quot;}'
    end when
    
    // Proceed with update
end serve
</code></pre>
              <h3>3. Handle Errors Gracefully</h3>
              <pre><code class="language-droe">// Good: Consistent error handling
serve get /users/:id
    set user from db find User where id equals id
    
    when user is empty then
        respond 404 with '{&quot;error&quot;: &quot;User not found&quot;, &quot;id&quot;: &quot;[id]&quot;}'
    end when
    
    when database_error then
        respond 500 with '{&quot;error&quot;: &quot;Internal server error&quot;}'
    end when
    
    respond 200 with user
end serve
</code></pre>
              <h2>Testing APIs</h2>
              <pre><code class="language-droe">// Test API endpoints
action test_user_api
    display &quot;Testing User API...&quot;
    
    // Test create user
    call &quot;http://localhost:8000/users&quot; method POST 
    with '{&quot;name&quot;: &quot;Test User&quot;, &quot;email&quot;: &quot;test@example.com&quot;}'
    using headers
        Content-Type: &quot;application/json&quot;
    end headers
    into create_response
    
    when create_response.status equals 201 then
        display &quot;✅ User creation successful&quot;
        set user_id from create_response.body.id
    otherwise
        display &quot;❌ User creation failed&quot;
    end when
    
    // Test get user
    call &quot;http://localhost:8000/users/[user_id]&quot; method GET into get_response
    when get_response.status equals 200 then
        display &quot;✅ User retrieval successful&quot;
    otherwise
        display &quot;❌ User retrieval failed&quot;
    end when
end action
</code></pre>
              <h2>Next Steps</h2>
              <ul>
                <li><strong><a href="/guide/mobile/">Mobile Development</a></strong> - Create mobile apps with API
                  integration</li>
                <li><strong><a href="/guide/frameworks/">Framework Support</a></strong> - Framework-specific API
                  generation</li>
                <li><strong><a href="/guide/database/">Database DSL</a></strong> - Database operations for APIs</li>
              </ul>
              <p>API endpoints in Droelang provide a clean, declarative way to build REST APIs while generating
                efficient framework-specific server code.</p>

            </article>
          </div>
        </main>

        <footer class="bg-gray-50 border-t border-gray-200">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
              <div class="md:col-span-2">
                <div class="flex items-center space-x-2 mb-4">
                  <img src="/logo.png" alt="Droe" class="w-6 h-6">
                  <span class="text-xl font-bold text-gray-900">Droe</span>
                </div>
                <p class="text-gray-600 max-w-md">
                  A unified programming system that compiles high-level app definitions to native, web, mobile, and
                  server runtimes.
                </p>
              </div>

              <div>
                <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider">Documentation</h3>
                <ul class="mt-4 space-y-4">
                  <li><a href="/guide/" class="text-base text-gray-500 hover:text-gray-900">Getting Started</a></li>
                  <li><a href="https://github.com/droe-lang/droe/tree/main/examples"
                      class="text-base text-gray-500 hover:text-gray-900">Examples</a></li>
                </ul>
              </div>

              <div>
                <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider">Community</h3>
                <ul class="mt-4 space-y-4">
                  <li><a href="https://github.com/droe-lang/droe"
                      class="text-base text-gray-500 hover:text-gray-900">GitHub</a></li>
                  <li><a href="https://github.com/droe-lang/droe/issues"
                      class="text-base text-gray-500 hover:text-gray-900">Issues</a></li>
                  <li><a href="https://github.com/droe-lang/droe/discussions"
                      class="text-base text-gray-500 hover:text-gray-900">Discussions</a></li>
                </ul>
              </div>
            </div>
            <div class="mt-8 border-t border-gray-200 pt-8 text-center">
              <p class="text-base text-gray-400">&copy; 2025 Droe. Open source under Apache 2.0 License.</p>
            </div>
          </div>
        </footer>

      </div>
    </div>
    <script>
      // Highlight current page in sidebar and handle mobile drawer
      document.addEventListener('DOMContentLoaded', function () {
        const currentPath = window.location.pathname;
        const sidebarLinks = document.querySelectorAll('aside nav a');

        // Highlight current page
        sidebarLinks.forEach(link => {
          if (link.getAttribute('href') === currentPath) {
            link.classList.add('bg-primary-50', 'text-primary-600', 'font-medium');
          }
        });

        // Mobile drawer functionality
        const menuToggleBtn = document.getElementById('menu-toggle-btn');
        const sidebar = document.getElementById('sidebar');
        const drawerOverlay = document.getElementById('drawer-overlay');

        function openDrawer() {
          sidebar.classList.remove('-translate-x-full');
          drawerOverlay.classList.remove('hidden');
          document.body.style.overflow = 'hidden';
        }

        function closeDrawer() {
          sidebar.classList.add('-translate-x-full');
          drawerOverlay.classList.add('hidden');
          document.body.style.overflow = '';
        }

        // Toggle drawer on mobile menu button click
        if (menuToggleBtn) {
          menuToggleBtn.addEventListener('click', openDrawer);
        }

        // Close drawer on overlay click
        drawerOverlay.addEventListener('click', closeDrawer);

        // Close drawer on link click (mobile navigation)
        sidebarLinks.forEach(link => {
          link.addEventListener('click', () => {
            if (window.innerWidth < 1024) {
              closeDrawer();
            }
          });
        });

        // Close drawer on escape key
        document.addEventListener('keydown', function (e) {
          if (e.key === 'Escape' && !sidebar.classList.contains('-translate-x-full') && window.innerWidth < 1024) {
            closeDrawer();
          }
        });

        // Handle window resize
        window.addEventListener('resize', function () {
          if (window.innerWidth >= 1024) {
            // Desktop: hide overlay and restore body scroll
            drawerOverlay.classList.add('hidden');
            document.body.style.overflow = '';
          }
        });
      });
    </script>
  </main>

  <!-- JavaScript for mobile menu -->
  <script>
    document.getElementById('mobile-menu-button').addEventListener('click', function () {
      const menu = document.getElementById('mobile-menu');
      menu.classList.toggle('hidden');
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', (event) => {
      const sidebar = document.getElementById('sidebar');
      if (sidebar) {
        const scrollPos = sessionStorage.getItem('sidebarScroll');
        if (scrollPos) {
          sidebar.scrollTop = parseInt(scrollPos, 10);
        }

        window.addEventListener('beforeunload', () => {
          sessionStorage.setItem('sidebarScroll', sidebar.scrollTop);
        });
      }

      // Add copy buttons to all code blocks
      const codeBlocks = document.querySelectorAll('pre code');
      codeBlocks.forEach((codeBlock) => {
        const pre = codeBlock.parentElement;
        pre.style.position = 'relative';

        const button = document.createElement('button');
        button.className = 'copy-btn';
        button.innerHTML = `
        <svg class="copy-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
          <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
        </svg>
        <svg class="check-icon" style="display:none;" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20 6L9 17l-5-5"></path>
        </svg>
      `;
        button.style.cssText = `
        position: absolute;
        top: 8px;
        right: 8px;
        padding: 6px;
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        cursor: pointer;
        opacity: 0;
        transition: opacity 0.2s, background-color 0.2s;
        display: flex;
        align-items: center;
        gap: 4px;
        color: #6b7280;
      `;

        pre.appendChild(button);

        // Show button on hover
        pre.addEventListener('mouseenter', () => {
          button.style.opacity = '1';
        });

        pre.addEventListener('mouseleave', () => {
          if (!button.classList.contains('copied')) {
            button.style.opacity = '0';
          }
        });

        button.addEventListener('click', async () => {
          const code = codeBlock.textContent;
          try {
            await navigator.clipboard.writeText(code);

            // Show success state
            button.classList.add('copied');
            button.style.background = '#10b981';
            button.style.borderColor = '#10b981';
            button.style.color = 'white';
            button.querySelector('.copy-icon').style.display = 'none';
            button.querySelector('.check-icon').style.display = 'block';

            setTimeout(() => {
              button.classList.remove('copied');
              button.style.background = 'rgba(255, 255, 255, 0.9)';
              button.style.borderColor = '#e5e7eb';
              button.style.color = '#6b7280';
              button.querySelector('.copy-icon').style.display = 'block';
              button.querySelector('.check-icon').style.display = 'none';
              button.style.opacity = '0';
            }, 2000);
          } catch (err) {
            console.error('Failed to copy:', err);
          }
        });
      });
    });
  </script>
</body>

</html>